tools:
  - tool_name: task.create
    description: Create a task. Use task_type=work for long-running background jobs handled by worker threads; use user_request/notification for main flow.
    input_schema:
      oneOf:
        - type: object
          properties:
            task_type:
              const: user_request
              description: Task type for user request.
            payload:
              type: object
              properties:
                user_message:
                  type: string
                  description: User message text.
              required: [user_message]
          required: [task_type, payload]
        - type: object
          properties:
            task_type:
              const: work
              description: Task type for background worker processing. For example, use it to run a task in 5 minutes or run a task every 2 hours.
            payload:
              type: object
              properties:
                message:
                  type: string
                  description: Work instruction message for the worker.
                run_at:
                  type: string
                  description: If this field is set, the task will be executed at the specified time. ISO8601 timestamp format.
                repeat_interval_seconds:
                  type: integer
                  description: If this field is set, the task will repeat at intervals. (minimum 3600).
                repeat_enabled:
                  type: boolean
                  description: Whether recurring execution is enabled.
              required: [message]
          required: [task_type, payload]
        - type: object
          properties:
            task_type:
              const: notification
              description: Notification task for main flow.
            payload:
              type: object
              properties:
                message:
                  type: string
                  description: Notification message to deliver.
              required: [message]
          required: [task_type, payload]
    output_schema:
      type: string
  - tool_name: task.update
    description: Update task fields using a partial patch (e.g., payload or state).
    input_schema:
      type: object
      properties:
        task_id:
          type: string
          description: Target task id.
        patch:
          type: object
          description: Partial update for fields like payload/state.
      required: [task_id, patch]
    output_schema:
      type: object
  - tool_name: task.get
    description: Fetch a task by id to inspect current state or payload.
    input_schema:
      type: object
      properties:
        task_id:
          type: string
          description: Task id to fetch.
      required: [task_id]
    output_schema:
      type: object
  - tool_name: task.list
    description: List tasks by filter. Use to check running work tasks or find queued work to claim.
    input_schema:
      type: object
      properties:
        task_type:
          type: string
          description: Filter by task type (e.g., work).
        state:
          type: string
          description: Filter by task state (default queued).
    output_schema:
      type: array
  - tool_name: task.claim
    description: Claim a task for execution with an exclusive lock (prevents other runners from claiming it).
    input_schema:
      type: object
      properties:
        filter_by:
          type: object
          description: Filter for claimable tasks (e.g., task_type=work).
        claimer_id:
          type: string
          description: Identifier for the claimer (runner id).
        ttl_seconds:
          type: integer
          description: Claim lease duration in seconds.
      required: [filter_by, claimer_id, ttl_seconds]
    output_schema:
      type: string
  - tool_name: task.complete
    description: Mark a task as done after confirming a work task completed.
    input_schema:
      type: object
      properties:
        task_id:
          type: string
          description: Task id to mark as done.
      required: [task_id]
    output_schema:
      type: object
  - tool_name: task.fail
    description: Mark a task as failed and attach error info.
    input_schema:
      type: object
      properties:
        task_id:
          type: string
          description: Task id to mark as failed.
        error_info:
          type: object
          description: Error metadata or reason.
      required: [task_id, error_info]
    output_schema:
      type: object
  - tool_name: artifact.write
    description: Store an artifact (e.g., detailed output, logs, or references) and return its id for later retrieval. web検索など外部の知識を利用した場合、artifactとして保存するようにします。
    input_schema:
      type: object
      properties:
        media_type:
          type: string
          description: Media type (e.g., text/markdown, application/json).
        body:
          type: string
          description: Artifact content.
        metadata:
          type: object
          description: Metadata for search/filtering.
      required: [media_type, body, metadata]
    output_schema:
      type: string
  - tool_name: artifact.read
    description: Read a stored artifact by id and return the full content. Prefer artifact.extract when you only need specific information.
    input_schema:
      type: object
      properties:
        artifact_id:
          type: string
          description: Artifact id to read.
      required: [artifact_id]
    output_schema:
      type: object
  - tool_name: artifact.search
    description: Search artifacts by semantic text query and/or metadata, then read with artifact.read.
    input_schema:
      type: object
      properties:
        query:
          type: object
          description: Search options such as text query, metadata filter, and k.
          properties:
            text:
              type: string
              description: Text query for semantic search.
            k:
              type: integer
              description: Number of results to return.
            metadata:
              type: object
              description: Exact-match metadata filter.
      required: [query]
    output_schema:
      type: array
  - tool_name: artifact.list
    description: List artifacts with metadata and a short body preview.
    input_schema:
      type: object
      properties: {}
    output_schema:
      type: array
  - tool_name: artifact.extract
    description: Extract specific information from an artifact using LLM. Prefer this over artifact.read for large content.
    input_schema:
      type: object
      properties:
        artifact_id:
          type: string
          description: Artifact id to extract from.
        instructions:
          type: string
          description: What information to extract.
      required: [artifact_id, instructions]
    output_schema:
      type: object
  - tool_name: turn.list_recent
    description: List recent conversation turns
    input_schema:
      type: object
      properties:
        conversation_id:
          type: string
        limit:
          type: integer
      required: [conversation_id, limit]
    output_schema:
      type: array
